{"remainingRequest":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tomo/Documents/projects/vue-diplomski/src/components/RoleForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tomo/Documents/projects/vue-diplomski/src/components/RoleForm.vue","mtime":1680973315984},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/babel-loader/lib/index.js","mtime":1680948621002},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js","mtime":1680948623381}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBkYiwgZmlyZWJhc2UgfSBmcm9tICJAL2ZpcmViYXNlIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUm9sZUZvcm0iLA0KICBwcm9wczogWyJpc0FkbWluIiwgImFsbFRlYW1zQW5kUHJvamVjdHMiLCAicmlnaHRzIl0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHVzZXI6ICIiLA0KICAgICAgcm9sZTogIiIsDQogICAgICB1c2VyUHJvamVjdDogIiIsDQogICAgICBhbGxVc2Vyc0FycjogW10sDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmZldGNoQWxsVXNlcnMoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldFRlYW1zKCkgew0KICAgICAgdGhpcy4kZW1pdCgiY2FsbC1nZXQtdGVhbXMiKTsNCiAgICB9LA0KICAgIHNldFJvbGUoKSB7DQogICAgICBpZiAoIXRoaXMudXNlciB8fCAhdGhpcy5yb2xlKSB7DQogICAgICAgIHRoaXMuJGFsZXJ0KCJGaWVsZHMgY2FudCBiZSBlbXB0eSEiLCAiV2FybmluZyIsICJ3YXJuaW5nIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGNvbnN0IHVzZXIgPSB0aGlzLnVzZXI7DQoNCiAgICAgIGNvbnN0IHJvbGVNYXAgPSB7DQogICAgICAgIGlzQWRtaW46IHsgaXNBZG1pbjogdHJ1ZSB9LA0KICAgICAgICBpc1RlYW1MZWFkOiB7IGlzVGVhbUxlYWQ6IHRydWUgfSwNCiAgICAgICAgZGVmYXVsdDogeyBpc1VzZXI6IHRydWUgfSwNCiAgICAgIH07DQoNCiAgICAgIGxldCBmb3VuZDsNCiAgICAgIGZvciAoY29uc3QgY2hlY2tVc2VyIG9mIHRoaXMuYWxsVXNlcnNBcnIpIHsNCiAgICAgICAgaWYgKGNoZWNrVXNlciA9PT0gdXNlcikgew0KICAgICAgICAgIGZvdW5kID0gdHJ1ZTsNCiAgICAgICAgICAvLyB0aGlzLiRhbGVydCgiVGhpcyB1c2VyIGFscmVhZHkgZXhpc3RzISIsICJXYXJuaW5nIiwgIndhcm5pbmciKTsNCiAgICAgICAgICAvLyByZXR1cm4NCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICBpZiAodGhpcy5yb2xlID09PSAnaXNVc2VyJyAmJiAodGhpcy51c2VyUHJvamVjdCA9PT0gJycgfHwgdGhpcy51c2VyUHJvamVjdCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMudXNlclByb2plY3QgPT09IG51bGwpKQ0KICAgICAgew0KICAgICAgICB0aGlzLiRhbGVydCgiQ2FudCBhZGQgdXNlciB0byBwcm9qZWN0IGJlY2FzdWUgdGhlcmUgcHJvamVjdHMgZG9lc250IGV4aXN0IiwgIldhcm5pbmciLCAid2FybmluZyIpDQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCg0KICAgICAgaWYgKGZvdW5kKSB7DQogICAgICAgIGRiLmNvbGxlY3Rpb24oInVzZXJzIikNCiAgICAgICAgICAuZ2V0KCkNCiAgICAgICAgICAudGhlbigocXVlcnkpID0+IHsNCiAgICAgICAgICAgIHF1ZXJ5LmZvckVhY2goKGRvYykgPT4gew0KICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZG9jLmRhdGEoKTsNCiAgICAgICAgICAgICAgaWYgKHVzZXIgPT09IGRhdGEudXNlcikgew0KICAgICAgICAgICAgICAgIGxldCBwcmV2aW91c1JvbGUgPSAiaXNVc2VyIjsNCiAgICAgICAgICAgICAgICBpZiAoZGF0YS5pc0FkbWluKSB7DQogICAgICAgICAgICAgICAgICBwcmV2aW91c1JvbGUgPSAiaXNBZG1pbiI7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmlzVGVhbUxlYWQpIHsNCiAgICAgICAgICAgICAgICAgIHByZXZpb3VzUm9sZSA9ICJpc1RlYW1MZWFkIjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY29uc3QgdXNlcklkID0gZG9jLmlkOw0KICAgICAgICAgICAgICAgIGRiLmNvbGxlY3Rpb24oInVzZXJzIikNCiAgICAgICAgICAgICAgICAgIC5kb2ModXNlcklkKQ0KICAgICAgICAgICAgICAgICAgLnVwZGF0ZSh7DQogICAgICAgICAgICAgICAgICAgIFtwcmV2aW91c1JvbGVdOiBmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRWYWx1ZS5kZWxldGUoKSwNCiAgICAgICAgICAgICAgICAgICAgW3RoaXMucm9sZV06IHRydWUsDQogICAgICAgICAgICAgICAgICAgIHVzZXI6IHRoaXMudXNlciwNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucm9sZSA9PT0gImlzVGVhbUxlYWQiKSB7DQogICAgICAgICAgICAgICAgICBkYi5jb2xsZWN0aW9uKCJ0ZWFtcyIpDQogICAgICAgICAgICAgICAgICAgIC53aGVyZSgibmFtZSIsICI9PSIsIHRoaXMudXNlclByb2plY3QudGVhbU5hbWUpDQogICAgICAgICAgICAgICAgICAgIC53aGVyZSgiYnVkZ2V0IiwgIj09IiwgdGhpcy51c2VyUHJvamVjdC50ZWFtQnVkZ2V0KQ0KICAgICAgICAgICAgICAgICAgICAuZ2V0KCkNCiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHNuYXBzaG90KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGVhbUlkID0gZG9jLmlkOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9jKHRlYW1JZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLnVwZGF0ZSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVhbWxlYWQ6IHRoaXMudXNlciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGFsZXJ0KCJBZGRlZCIsICJTdWNjZXNzIiwgInN1Y2Nlc3MiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGVhbXMoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgYWRkaW5nIHByb2plY3Q6IiwgZXJyb3IpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGdldHRpbmcgdGVhbToiLCBlcnJvcik7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5yb2xlID09PSAnaXNVc2VyJykNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgICAgICAgLmdldCgpDQogICAgICAgICAgICAgICAgICAudGhlbigoc25hcHNob3QpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCJlcnJvciIpOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtID0gZG9jLmRhdGEoKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtSWQgPSBkb2MuaWQ7DQogICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwcm9qZWN0IG9mIHRlYW0ucHJvamVjdHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdC5wcm9qZWN0TmFtZSA9PT0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJQcm9qZWN0LnByb2plY3ROYW1lICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3QucHJvamVjdEJ1ZGdldCA9PT0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJQcm9qZWN0LnByb2plY3RCdWRnZXQNCiAgICAgICAgICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSB0ZWFtLnByb2plY3RzLmluZGV4T2YocHJvamVjdCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kb2ModGVhbUlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChkb2MpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRUZWFtID0gZG9jLmRhdGEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUZWFtLnByb2plY3RzW3Byb2plY3RJbmRleF0ucGVvcGxlLnB1c2goDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiLmNvbGxlY3Rpb24oInRlYW1zIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvYyh0ZWFtSWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXQodXBkYXRlZFRlYW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRhbGVydCgiQWRkZWQiLCAiU3VjY2VzcyIsICJzdWNjZXNzIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGVhbXMoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnN0IHJvbGUgPSByb2xlTWFwW3RoaXMucm9sZV0gfHwgcm9sZU1hcC5kZWZhdWx0Ow0KICAgICAgICBpZiAodGhpcy5yb2xlID09PSAiaXNVc2VyIikgew0KICAgICAgICAgIGZvciAoY29uc3QgdGVhbSBvZiB0aGlzLmFsbFRlYW1zQW5kUHJvamVjdHMudGVhbXNXaXRoUHJvamVjdHMpIHsNCiAgICAgICAgICAgIGZvciAoY29uc3QgcHJvamVjdCBvZiB0ZWFtLnByb2plY3RzKSB7DQogICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICBwcm9qZWN0LnByb2plY3ROYW1lID09PSB0aGlzLnVzZXJQcm9qZWN0LnByb2plY3ROYW1lICYmDQogICAgICAgICAgICAgICAgcHJvamVjdC5wcm9qZWN0QnVkZ2V0ID09PSB0aGlzLnVzZXJQcm9qZWN0LnByb2plY3RCdWRnZXQNCiAgICAgICAgICAgICAgKSB7DQogICAgICAgICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgICAgICAgLmdldCgpDQogICAgICAgICAgICAgICAgICAudGhlbigoc25hcHNob3QpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCJlcnJvciIpOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtID0gZG9jLmRhdGEoKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZWFtSWQgPSBkb2MuaWQ7DQogICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwcm9qZWN0IG9mIHRlYW0ucHJvamVjdHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdC5wcm9qZWN0TmFtZSA9PT0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJQcm9qZWN0LnByb2plY3ROYW1lICYmDQogICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3QucHJvamVjdEJ1ZGdldCA9PT0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJQcm9qZWN0LnByb2plY3RCdWRnZXQNCiAgICAgICAgICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSB0ZWFtLnByb2plY3RzLmluZGV4T2YocHJvamVjdCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kb2ModGVhbUlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChkb2MpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRUZWFtID0gZG9jLmRhdGEoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUZWFtLnByb2plY3RzW3Byb2plY3RJbmRleF0ucGVvcGxlLnB1c2goDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiLmNvbGxlY3Rpb24oInRlYW1zIikNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvYyh0ZWFtSWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZXQodXBkYXRlZFRlYW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRhbGVydCgiQWRkZWQiLCAiU3VjY2VzcyIsICJzdWNjZXNzIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGVhbXMoKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJvbGUgPT09ICJpc1RlYW1MZWFkIikgew0KICAgICAgICAgIGRiLmNvbGxlY3Rpb24oInRlYW1zIikNCiAgICAgICAgICAgIC53aGVyZSgibmFtZSIsICI9PSIsIHRoaXMudXNlclByb2plY3QudGVhbU5hbWUpDQogICAgICAgICAgICAud2hlcmUoImJ1ZGdldCIsICI9PSIsIHRoaXMudXNlclByb2plY3QudGVhbUJ1ZGdldCkNCiAgICAgICAgICAgIC5nZXQoKQ0KICAgICAgICAgICAgLnRoZW4oKHNuYXBzaG90KSA9PiB7DQogICAgICAgICAgICAgIGlmIChzbmFwc2hvdC5lbXB0eSkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBzbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCB0ZWFtSWQgPSBkb2MuaWQ7DQogICAgICAgICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgICAgICAgLmRvYyh0ZWFtSWQpDQogICAgICAgICAgICAgICAgICAudXBkYXRlKHsNCiAgICAgICAgICAgICAgICAgICAgdGVhbWxlYWQ6IHRoaXMudXNlciwNCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiANCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYWxlcnQoIkFkZGVkIiwgIlN1Y2Nlc3MiLCAic3VjY2VzcyIpDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGVhbXMoKQ0KICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgYWRkaW5nIHByb2plY3Q6IiwgZXJyb3IpOw0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsNCiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgZ2V0dGluZyB0ZWFtOiIsIGVycm9yKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIGRiLmNvbGxlY3Rpb24oInVzZXJzIikNCiAgICAgICAgICAuYWRkKHsgdXNlcjogdGhpcy51c2VyLCAuLi5yb2xlIH0pDQogICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgY29uc3Qgcm9sZU1hcCA9IHsNCiAgICAgICAgICAgICAgaXNBZG1pbjogImFkbWluIiwNCiAgICAgICAgICAgICAgaXNUZWFtTGVhZDogInRlYW1sZWFkIiwNCiAgICAgICAgICAgICAgZGVmYXVsdDogInVzZXIiLA0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGNvbnN0IHJvbGEgPSByb2xlTWFwW3RoaXMucm9sZV0gfHwgcm9sZU1hcC5kZWZhdWx0Ow0KICAgICAgICAgICAgdGhpcy4kYWxlcnQoDQogICAgICAgICAgICAgIGBVc2VyICR7dGhpcy51c2VyfSBpcyBzZXQgYXMgJHtyb2xhfWAsDQogICAgICAgICAgICAgICJTdWNjZXNzIiwNCiAgICAgICAgICAgICAgInN1Y2Nlc3MiDQogICAgICAgICAgICApOw0KICAgICAgICAgICAgdGhpcy51c2VyID0gIiI7DQogICAgICAgICAgICB0aGlzLnJvbGUgPSAiIjsNCiAgICAgICAgICAgIHRoaXMuZ2V0VGVhbXMoKTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsNCiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KGVycm9yLCAiRXJyb3IiLCAiZXJyb3IiKTsNCiAgICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGZldGNoQWxsVXNlcnMoKSB7DQogICAgICBkYi5jb2xsZWN0aW9uKCJ1c2VycyIpDQogICAgICAgIC5nZXQoKQ0KICAgICAgICAudGhlbigocXVlcnkpID0+IHsNCiAgICAgICAgICBxdWVyeS5mb3JFYWNoKChkb2MpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBkb2MuZGF0YSgpOw0KICAgICAgICAgICAgY29uc3QgdXNlciA9IGRhdGEudXNlcjsNCiAgICAgICAgICAgIGlmICghZGF0YS5pc0FkbWluIHx8ICFkYXRhLmlzVGVhbUxlYWQpIHsNCiAgICAgICAgICAgICAgdGhpcy5hbGxVc2Vyc0Fyci5wdXNoKHVzZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgICB9KTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["RoleForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RoleForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"flex\">\r\n    <div class=\"form-group\" v-if=\"isAdmin\">\r\n      <h1>Set roles for users</h1>\r\n      <form class=\"form-group border\">\r\n        <label for=\"select-field\">Select role</label>\r\n        <select id=\"select-field\" v-model=\"role\">\r\n          <option value=\"isAdmin\">Admin</option>\r\n          <option value=\"isTeamLead\">Teamlead</option>\r\n          <option value=\"isUser\">User</option>\r\n        </select>\r\n        <div\r\n          v-if=\"role === 'isUser' && allTeamsAndProjects.onlyProjecsts.length\"\r\n        >\r\n          <div>Add this user to project</div>\r\n          <select id=\"select-field\" v-model=\"userProject\">\r\n            <option\r\n              v-for=\"(project, index) in allTeamsAndProjects.onlyProjecsts\"\r\n              :key=\"index\"\r\n              :value=\"project\"\r\n            >\r\n              {{ project.projectName }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n        <div\r\n          v-if=\"\r\n            role === 'isTeamLead' &&\r\n            allTeamsAndProjects.teamsWithProjects.length\r\n          \"\r\n        >\r\n          <div>Add this team lead to team</div>\r\n          <select id=\"select-field\" v-model=\"userProject\">\r\n            <option\r\n              v-for=\"(team, index) in allTeamsAndProjects.teamsWithProjects\"\r\n              :key=\"index\"\r\n              :value=\"team\"\r\n            >\r\n              {{ team.teamName }}\r\n            </option>\r\n          </select>\r\n        </div>\r\n        <label for=\"reason-field\">Select user</label>\r\n        <select id=\"select-field\" v-model=\"user\">\r\n          <option\r\n            v-for=\"(user, index) in allUsersArr\"\r\n            :key=\"index\"\r\n            :value=\"user\"\r\n          >\r\n            {{ user }}\r\n          </option>\r\n        </select>\r\n        <div\r\n          class=\"blue-button\"\r\n          style=\"margin-top: 10px\"\r\n          @click=\"setRole(user, role, userProject)\"\r\n        >\r\n          Submit\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { db, firebase } from \"@/firebase\";\r\n\r\nexport default {\r\n  name: \"RoleForm\",\r\n  props: [\"isAdmin\", \"allTeamsAndProjects\", \"rights\"],\r\n  data() {\r\n    return {\r\n      user: \"\",\r\n      role: \"\",\r\n      userProject: \"\",\r\n      allUsersArr: [],\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchAllUsers();\r\n  },\r\n  methods: {\r\n    getTeams() {\r\n      this.$emit(\"call-get-teams\");\r\n    },\r\n    setRole() {\r\n      if (!this.user || !this.role) {\r\n        this.$alert(\"Fields cant be empty!\", \"Warning\", \"warning\");\r\n        return;\r\n      }\r\n      const user = this.user;\r\n\r\n      const roleMap = {\r\n        isAdmin: { isAdmin: true },\r\n        isTeamLead: { isTeamLead: true },\r\n        default: { isUser: true },\r\n      };\r\n\r\n      let found;\r\n      for (const checkUser of this.allUsersArr) {\r\n        if (checkUser === user) {\r\n          found = true;\r\n          // this.$alert(\"This user already exists!\", \"Warning\", \"warning\");\r\n          // return\r\n        }\r\n      }\r\n\r\n      if (this.role === 'isUser' && (this.userProject === '' || this.userProject === undefined || this.userProject === null))\r\n      {\r\n        this.$alert(\"Cant add user to project becasue there projects doesnt exist\", \"Warning\", \"warning\")\r\n        return;\r\n      }\r\n\r\n      if (found) {\r\n        db.collection(\"users\")\r\n          .get()\r\n          .then((query) => {\r\n            query.forEach((doc) => {\r\n              const data = doc.data();\r\n              if (user === data.user) {\r\n                let previousRole = \"isUser\";\r\n                if (data.isAdmin) {\r\n                  previousRole = \"isAdmin\";\r\n                } else if (data.isTeamLead) {\r\n                  previousRole = \"isTeamLead\";\r\n                }\r\n                const userId = doc.id;\r\n                db.collection(\"users\")\r\n                  .doc(userId)\r\n                  .update({\r\n                    [previousRole]: firebase.firestore.FieldValue.delete(),\r\n                    [this.role]: true,\r\n                    user: this.user,\r\n                  });\r\n                  if (this.role === \"isTeamLead\") {\r\n                  db.collection(\"teams\")\r\n                    .where(\"name\", \"==\", this.userProject.teamName)\r\n                    .where(\"budget\", \"==\", this.userProject.teamBudget)\r\n                    .get()\r\n                    .then((snapshot) => {\r\n                      if (snapshot.empty) {\r\n                        return;\r\n                      }\r\n                      snapshot.forEach((doc) => {\r\n                        const teamId = doc.id;\r\n                        db.collection(\"teams\")\r\n                          .doc(teamId)\r\n                          .update({\r\n                            teamlead: this.user,\r\n                          })\r\n                          .then(() => {\r\n                            this.$alert(\"Added\", \"Success\", \"success\")\r\n                            this.getTeams()\r\n                          })\r\n                          .catch((error) => {\r\n                            console.error(\"Error adding project:\", error);\r\n                          });\r\n                      });\r\n                    })\r\n                    .catch((error) => {\r\n                      console.error(\"Error getting team:\", error);\r\n                    });\r\n                  }\r\n                  else if (this.role === 'isUser')\r\n                  {\r\n                    db.collection(\"teams\")\r\n                  .get()\r\n                  .then((snapshot) => {\r\n                    if (snapshot.empty) {\r\n                      console.warn(\"error\");\r\n                      return;\r\n                    }\r\n                    snapshot.forEach((doc) => {\r\n                      const team = doc.data();\r\n                      const teamId = doc.id;\r\n                      for (const project of team.projects) {\r\n                        if (\r\n                          project.projectName ===\r\n                            this.userProject.projectName &&\r\n                          project.projectBudget ===\r\n                            this.userProject.projectBudget\r\n                        ) {\r\n                          const projectIndex = team.projects.indexOf(project);\r\n\r\n                          db.collection(\"teams\")\r\n                            .doc(teamId)\r\n                            .get()\r\n                            .then((doc) => {\r\n                              const updatedTeam = doc.data();\r\n                              updatedTeam.projects[projectIndex].people.push(\r\n                                user\r\n                              );\r\n\r\n                              db.collection(\"teams\")\r\n                                .doc(teamId)\r\n                                .set(updatedTeam);\r\n                                this.$alert(\"Added\", \"Success\", \"success\");\r\n                                this.getTeams()\r\n                            });\r\n                        }\r\n                      }\r\n                    });\r\n                  });\r\n                  }\r\n                }\r\n            });\r\n          });\r\n      } else {\r\n        const role = roleMap[this.role] || roleMap.default;\r\n        if (this.role === \"isUser\") {\r\n          for (const team of this.allTeamsAndProjects.teamsWithProjects) {\r\n            for (const project of team.projects) {\r\n              if (\r\n                project.projectName === this.userProject.projectName &&\r\n                project.projectBudget === this.userProject.projectBudget\r\n              ) {\r\n                db.collection(\"teams\")\r\n                  .get()\r\n                  .then((snapshot) => {\r\n                    if (snapshot.empty) {\r\n                      console.warn(\"error\");\r\n                      return;\r\n                    }\r\n                    snapshot.forEach((doc) => {\r\n                      const team = doc.data();\r\n                      const teamId = doc.id;\r\n                      for (const project of team.projects) {\r\n                        if (\r\n                          project.projectName ===\r\n                            this.userProject.projectName &&\r\n                          project.projectBudget ===\r\n                            this.userProject.projectBudget\r\n                        ) {\r\n                          const projectIndex = team.projects.indexOf(project);\r\n\r\n                          db.collection(\"teams\")\r\n                            .doc(teamId)\r\n                            .get()\r\n                            .then((doc) => {\r\n                              const updatedTeam = doc.data();\r\n                              updatedTeam.projects[projectIndex].people.push(\r\n                                user\r\n                              );\r\n\r\n                              db.collection(\"teams\")\r\n                                .doc(teamId)\r\n                                .set(updatedTeam);\r\n                                this.$alert(\"Added\", \"Success\", \"success\");\r\n                                this.getTeams()\r\n                            });\r\n                        }\r\n                      }\r\n                    });\r\n                  });\r\n              }\r\n            }\r\n          }\r\n        } else if (this.role === \"isTeamLead\") {\r\n          db.collection(\"teams\")\r\n            .where(\"name\", \"==\", this.userProject.teamName)\r\n            .where(\"budget\", \"==\", this.userProject.teamBudget)\r\n            .get()\r\n            .then((snapshot) => {\r\n              if (snapshot.empty) {\r\n                return;\r\n              }\r\n              snapshot.forEach((doc) => {\r\n                const teamId = doc.id;\r\n                db.collection(\"teams\")\r\n                  .doc(teamId)\r\n                  .update({\r\n                    teamlead: this.user,\r\n                  })\r\n                  .then(() => \r\n                  {\r\n                    this.$alert(\"Added\", \"Success\", \"success\")\r\n                    this.getTeams()\r\n                  })\r\n                  .catch((error) => {\r\n                    console.error(\"Error adding project:\", error);\r\n                  });\r\n              });\r\n            })\r\n            .catch((error) => {\r\n              console.error(\"Error getting team:\", error);\r\n            });\r\n        }\r\n        db.collection(\"users\")\r\n          .add({ user: this.user, ...role })\r\n          .then(() => {\r\n            const roleMap = {\r\n              isAdmin: \"admin\",\r\n              isTeamLead: \"teamlead\",\r\n              default: \"user\",\r\n            };\r\n            const rola = roleMap[this.role] || roleMap.default;\r\n            this.$alert(\r\n              `User ${this.user} is set as ${rola}`,\r\n              \"Success\",\r\n              \"success\"\r\n            );\r\n            this.user = \"\";\r\n            this.role = \"\";\r\n            this.getTeams();\r\n          })\r\n          .catch((error) => {\r\n            this.$alert(error, \"Error\", \"error\");\r\n          });\r\n      }\r\n    },\r\n    fetchAllUsers() {\r\n      db.collection(\"users\")\r\n        .get()\r\n        .then((query) => {\r\n          query.forEach((doc) => {\r\n            const data = doc.data();\r\n            const user = data.user;\r\n            if (!data.isAdmin || !data.isTeamLead) {\r\n              this.allUsersArr.push(user);\r\n            }\r\n          });\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.blue-button {\r\n  display: block;\r\n  width: 40%;\r\n  padding: 10px 0;\r\n  text-align: center;\r\n  background-color: rgba(41, 133, 133, 0.3);\r\n  color: white;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  border: 1px solid black;\r\n}\r\n\r\n.border {\r\n  border: 1px solid black;\r\n  border-radius: 10px;\r\n  height: 100%;\r\n  padding: 10px;\r\n  margin: 10px;\r\n  background-color: rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.flex {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  align-content: center;\r\n  justify-content: center;\r\n}\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 97%;\r\n  width: 80%;\r\n  justify-content: space-evenly;\r\n  align-items: center;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  font-weight: bold;\r\n  margin: 0px 20px;\r\n}\r\n\r\n.form-group input {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n.form-group select {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n</style>"]}]}