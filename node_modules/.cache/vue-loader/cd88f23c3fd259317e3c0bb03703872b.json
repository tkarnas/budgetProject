{"remainingRequest":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tomo/Documents/projects/vue-diplomski/src/components/Projects.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tomo/Documents/projects/vue-diplomski/src/components/Projects.vue","mtime":1680948623761},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/thread-loader/dist/cjs.js","mtime":1680948623124},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/babel-loader/lib/index.js","mtime":1680948621002},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js","mtime":1680948623381}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgR3JhcGggZnJvbSAiLi4vY29tcG9uZW50cy9HcmFwaC52dWUiOw0KaW1wb3J0IHsgZGIgfSBmcm9tICJAL2ZpcmViYXNlIjsNCmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlLmpzIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUm9sZUZvcm0iLA0KICBjb21wb25lbnRzOiB7DQogICAgR3JhcGgsDQogIH0sDQogIHByb3BzOiBbDQogICAgImlzQWRtaW4iLA0KICAgICJpc1RlYW1MZWFkIiwNCiAgICAiaXNVc2VyIiwNCiAgICAidGVhbSIsDQogICAgInJpZ2h0cyIsDQogICAgInRlYW1JbmRleCIsDQogICAgInRlYW1zIiwNCiAgXSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgaXNDbGlja2VkOiBmYWxzZSwNCiAgICAgIGlzQ2xpY2tlZDI6IGZhbHNlLA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRUZWFtcygpIHsNCiAgICAgIHRoaXMuJGVtaXQoImNhbGwtZ2V0LXRlYW1zIik7DQogICAgfSwNCiAgICBzaG93Tm9Qcm9qZWN0c1dpbmRvdygpIHsNCiAgICAgIHRoaXMuJGVtaXQoIm5vLXByb2plY3RzIik7DQogICAgfSwNCiAgICB1c2VyQ2FuU2VlKHByb2plY3QpIHsNCiAgICAgIGlmICh0aGlzLnJpZ2h0cyA9PT0gIkFkbWluIiB8fCB0aGlzLnJpZ2h0cyA9PT0gIlRlYW0gTGVhZCIpIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICB9DQogICAgICBpZiAocHJvamVjdC5wZW9wbGUgJiYgcHJvamVjdC5wZW9wbGUubGVuZ3RoKSB7DQogICAgICAgIGxldCBmb3VuZDsNCiAgICAgICAgZm9yIChjb25zdCB1c2VyIG9mIHByb2plY3QucGVvcGxlKSB7DQogICAgICAgICAgaWYgKHVzZXIgPT09IHRoaXMuc2lnbmVkVXNlcikgew0KICAgICAgICAgICAgZm91bmQgPSB0cnVlOw0KICAgICAgICAgICAgaWYgKCFmb3VuZCkgew0KICAgICAgICAgICAgICB0aGlzLnNob3dOb1Byb2plY3RzV2luZG93KCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICB9DQogICAgICB0aGlzLnNob3dOb1Byb2plY3RzV2luZG93KCk7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfSwNCiAgICBkZWxldGVQcm9qZWN0KHRlYW1JbmRleCwgcHJvamVjdEluZGV4LCBwcm9qZWN0KSB7DQogICAgICB0aGlzLiRjb25maXJtKCJBcmUgeW91IHN1cmU/IikudGhlbigoKSA9PiB7DQogICAgICAgIGNvbnN0IHRlYW0gPSB0aGlzLnRlYW1zW3RlYW1JbmRleF07DQogICAgICAgIGRiLmNvbGxlY3Rpb24oInRlYW1zIikNCiAgICAgICAgICAud2hlcmUoIm5hbWUiLCAiPT0iLCB0ZWFtLnRlYW1OYW1lKQ0KICAgICAgICAgIC53aGVyZSgiYnVkZ2V0IiwgIj09IiwgdGVhbS50ZWFtQnVkZ2V0KQ0KICAgICAgICAgIC5nZXQoKQ0KICAgICAgICAgIC50aGVuKChzbmFwc2hvdCkgPT4gew0KICAgICAgICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7DQogICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4gew0KICAgICAgICAgICAgICBjb25zdCB0ZWFtSWQgPSBkb2MuaWQ7DQogICAgICAgICAgICAgIGxldCBwcm9qZWN0cyA9IGRvYy5kYXRhKCkucHJvamVjdHM7DQogICAgICAgICAgICAgIHByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKA0KICAgICAgICAgICAgICAgIChwcm9qZWN0LCBpbmRleCkgPT4gaW5kZXggIT09IHByb2plY3RJbmRleA0KICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICBkYi5jb2xsZWN0aW9uKCJ0ZWFtcyIpDQogICAgICAgICAgICAgICAgLmRvYyh0ZWFtSWQpDQogICAgICAgICAgICAgICAgLnVwZGF0ZSh7DQogICAgICAgICAgICAgICAgICBwcm9qZWN0czogcHJvamVjdHMsDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICB0aGlzLiRhbGVydCgNCiAgICAgICAgICAgICAgICAgICAgYFByb2plY3QgJHtwcm9qZWN0LnByb2plY3ROYW1lfSBkZWxldGVkYCwNCiAgICAgICAgICAgICAgICAgICAgIlN1Y2Nlc3MiLA0KICAgICAgICAgICAgICAgICAgICAic3VjY2VzcyINCiAgICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgICB0aGlzLmdldFRlYW1zKCk7DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgICAgICAgICB0aGlzLiRhbGVydChlcnJvciwgIkVycm9yIiwgImVycm9yIik7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsNCiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KGVycm9yLCAiRXJyb3IiLCAiZXJyb3IiKTsNCiAgICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0sDQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgc2lnbmVkVXNlcigpIHsNCiAgICAgIHJldHVybiBzdG9yZS5jdXJyZW50VXNlcjsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["Projects.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Projects.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <ul v-if=\"isAdmin || isTeamLead || isUser\">\r\n      <li v-for=\"(project, projectIndex) in team.projects\" :key=\"projectIndex\">\r\n        <div class=\"projects\" v-if=\"userCanSee(project)\">\r\n          Project Name: {{ project.projectName }}\r\n          <div v-if=\"!isUser\">\r\n            Project Budget: {{ project.projectBudget }} €\r\n            <br />\r\n            <b\r\n              >Left:\r\n              {{\r\n                project.projectBudget -\r\n                project.expenses.reduce((a, b) => a + (b[\"amount\"] || 0), 0)\r\n              }}\r\n              €</b\r\n            >\r\n          </div>\r\n          <div\r\n            class=\"button\"\r\n            v-if=\"project.expenses.length && !isUser\"\r\n            @click=\"isClicked = !isClicked\"\r\n          >\r\n            Check expenses\r\n            <div v-if=\"isClicked\">\r\n              <div v-for=\"(expense, index) in project.expenses\" :key=\"index\">\r\n                {{ expense.moment }} - {{ expense.amount }} € - Reason:\r\n                {{ expense.reason }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"expand\"\r\n            v-if=\"project.people.length && !isUser\"\r\n            @click=\"isClicked2 = !isClicked2\"\r\n          >\r\n            Project members\r\n            <div v-if=\"isClicked2\">\r\n              <div v-for=\"(people, index) in project.people\" :key=\"index\">\r\n                {{ people }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"!isUser\">\r\n            <Graph :project=\"project\"></Graph>\r\n          </div>\r\n          <div\r\n            class=\"red-button\"\r\n            v-if=\"isAdmin\"\r\n            @click=\"deleteProject(teamIndex, projectIndex, project)\"\r\n          >\r\n            Delete\r\n          </div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Graph from \"../components/Graph.vue\";\r\nimport { db } from \"@/firebase\";\r\nimport store from \"@/store.js\";\r\n\r\nexport default {\r\n  name: \"RoleForm\",\r\n  components: {\r\n    Graph,\r\n  },\r\n  props: [\r\n    \"isAdmin\",\r\n    \"isTeamLead\",\r\n    \"isUser\",\r\n    \"team\",\r\n    \"rights\",\r\n    \"teamIndex\",\r\n    \"teams\",\r\n  ],\r\n  data() {\r\n    return {\r\n      isClicked: false,\r\n      isClicked2: false,\r\n    };\r\n  },\r\n  methods: {\r\n    getTeams() {\r\n      this.$emit(\"call-get-teams\");\r\n    },\r\n    showNoProjectsWindow() {\r\n      this.$emit(\"no-projects\");\r\n    },\r\n    userCanSee(project) {\r\n      if (this.rights === \"Admin\" || this.rights === \"Team Lead\") {\r\n        return true;\r\n      }\r\n      if (project.people && project.people.length) {\r\n        let found;\r\n        for (const user of project.people) {\r\n          if (user === this.signedUser) {\r\n            found = true;\r\n            if (!found) {\r\n              this.showNoProjectsWindow();\r\n            }\r\n          }\r\n          return true;\r\n        }\r\n      }\r\n      this.showNoProjectsWindow();\r\n      return false;\r\n    },\r\n    deleteProject(teamIndex, projectIndex, project) {\r\n      this.$confirm(\"Are you sure?\").then(() => {\r\n        const team = this.teams[teamIndex];\r\n        db.collection(\"teams\")\r\n          .where(\"name\", \"==\", team.teamName)\r\n          .where(\"budget\", \"==\", team.teamBudget)\r\n          .get()\r\n          .then((snapshot) => {\r\n            if (snapshot.empty) {\r\n              return;\r\n            }\r\n            snapshot.forEach((doc) => {\r\n              const teamId = doc.id;\r\n              let projects = doc.data().projects;\r\n              projects = projects.filter(\r\n                (project, index) => index !== projectIndex\r\n              );\r\n              db.collection(\"teams\")\r\n                .doc(teamId)\r\n                .update({\r\n                  projects: projects,\r\n                })\r\n                .then(() => {\r\n                  this.$alert(\r\n                    `Project ${project.projectName} deleted`,\r\n                    \"Success\",\r\n                    \"success\"\r\n                  );\r\n                  this.getTeams();\r\n                })\r\n                .catch((error) => {\r\n                  this.$alert(error, \"Error\", \"error\");\r\n                });\r\n            });\r\n          })\r\n          .catch((error) => {\r\n            this.$alert(error, \"Error\", \"error\");\r\n          });\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    signedUser() {\r\n      return store.currentUser;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.red-button {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(255, 0, 0, 0.13);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.button {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(136, 238, 69, 0.288);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.expand {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(43, 146, 172, 0.438);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.projects {\r\n  margin-top: 20px;\r\n  background-color: rgba(240, 230, 140, 0.2);\r\n  max-width: 100%;\r\n  border: 1px solid black;\r\n  border-radius: 4px;\r\n  padding: 5px;\r\n}\r\n\r\nul {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\nli {\r\n  margin: 10px 0;\r\n}\r\n</style>"]}]}