{"remainingRequest":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\tomis\\Desktop\\vue-diplomski\\src\\components\\ProjectForm.vue?vue&type=style&index=0&id=11cc6206&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\src\\components\\ProjectForm.vue","mtime":1676484596874},{"path":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\node_modules\\css-loader\\dist\\cjs.js","mtime":1675708644701},{"path":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1675708908727},{"path":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\node_modules\\postcss-loader\\src\\index.js","mtime":1675708820835},{"path":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1675708577019},{"path":"C:\\Users\\tomis\\Desktop\\vue-diplomski\\node_modules\\vue-loader\\lib\\index.js","mtime":1675708908543}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoNCi5mb3JtLWdyb3VwIHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgd2lkdGg6IDEwMCU7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KfQ0KDQouZm9ybS1ncm91cCBsYWJlbCB7DQogIGRpc3BsYXk6IGJsb2NrOw0KICBmb250LXdlaWdodDogYm9sZDsNCiAgbWFyZ2luOiAwcHggMjBweDsNCn0NCg0KLmZvcm0tZ3JvdXAgaW5wdXQgew0KICBkaXNwbGF5OiBibG9jazsNCiAgd2lkdGg6IDEwMCU7DQogIHBhZGRpbmc6IDEwcHg7DQogIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KLmZvcm0tZ3JvdXAgc2VsZWN0IHsNCiAgZGlzcGxheTogYmxvY2s7DQogIHdpZHRoOiAzMCU7DQogIHBhZGRpbmc6IDEwcHg7DQogIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KLmJsdWUtYnV0dG9uIHsNCiAgZGlzcGxheTogYmxvY2s7DQogIHdpZHRoOiAxMDAlOw0KICBwYWRkaW5nOiAxMHB4Ow0KICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDQxLCAxMzMsIDEzMywgMC4zKTsNCiAgY29sb3I6IGJsYWNrOw0KICBib3JkZXI6IG5vbmU7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBib3JkZXI6IDFweCBzb2xpZCBibGFjazsNCn0NCg0KLnJlZC1idXR0b24gew0KICBkaXNwbGF5OiBibG9jazsNCiAgd2lkdGg6IDQwJTsNCiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDAsIDAsIDAuMjUpOw0KICBib3JkZXI6IG5vbmU7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBtYXJnaW4tdG9wOiAycHg7DQogIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOw0KfQ0K"},{"version":3,"sources":["ProjectForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProjectForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <form v-if=\"isAdmin || isTeamLead\">\r\n        <div class=\"form-group\" ref_testcafe=\"addProjectForm\">\r\n            <label for=\"projectName\">Project Name</label>\r\n            <input\r\n            type=\"text\"\r\n            id=\"projectName\"\r\n            v-model=\"projectName\"\r\n            placeholder=\"Enter project name\"\r\n            />\r\n            <label for=\"projectBudget\">Project budget</label>\r\n            <input\r\n            type=\"number\"\r\n            id=\"projectBudget\"\r\n            v-model=\"projectBudget\"\r\n            placeholder=\"Enter project budget\"\r\n            />\r\n        </div>\r\n        <button\r\n            class=\"blue-button\"\r\n            type=\"submit\"\r\n            @click.prevent=\"addProject(team)\"\r\n            ref_testcafe=\"submitAddProjectButton\"\r\n        >\r\n            Add Project\r\n        </button>\r\n        <button\r\n            class=\"red-button\"\r\n            type=\"submit\"\r\n            v-if=\"isAdmin\"\r\n            @click.prevent=\"deleteTeam(team)\"\r\n        >\r\n            Delete Team\r\n        </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { db } from \"@/firebase\";\r\n\r\nexport default {\r\n  name: \"ProjectForm\",\r\n  props: [\"isAdmin\", \"isTeamLead\", \"isUser\", \"team\"],\r\n  data() {\r\n    return {\r\n      projectName: \"\",\r\n      projectBudget: null,\r\n    };\r\n  },\r\n  methods:\r\n  {\r\n    getTeams() {\r\n      this.$emit(\"call-get-teams\");\r\n    },\r\n    async addProject(team) {\r\n      if (\r\n        this.projectName != null &&\r\n        this.projectBudget != null &&\r\n        this.projectName != \"\" &&\r\n        this.projectBudget != \"\"\r\n      ) {\r\n        if (typeof parseInt(this.projectBudget, 10) === \"number\") {\r\n          if (parseInt(this.projectBudget, 10) > team.teamBudget) {\r\n            this.$alert(\"Number over the budget\", \"Warning\", \"warning\");\r\n            return;\r\n          }\r\n          let projectAlreadyLost = 0;\r\n          for (const project of team.projects) {\r\n            projectAlreadyLost += parseInt(project.projectBudget, 10);\r\n          }\r\n          if (\r\n            projectAlreadyLost + parseInt(this.projectBudget, 10) >\r\n            team.teamBudget\r\n          ) {\r\n            this.$alert(\"insufficient funds\", \"Warning\", \"warning\");\r\n            return;\r\n          }\r\n\r\n          db.collection(\"teams\")\r\n            .where(\"name\", \"==\", team.teamName)\r\n            .where(\"budget\", \"==\", team.teamBudget)\r\n            .get()\r\n            .then((snapshot) => {\r\n              if (snapshot.empty) {\r\n                return;\r\n              }\r\n              snapshot.forEach((doc) => {\r\n                const projectId = doc.id;\r\n                let projects = doc.data().projects;\r\n                projects.push({\r\n                  projectName: this.projectName,\r\n                  projectBudget: this.projectBudget,\r\n                  expenses: [],\r\n                  people: [],\r\n                });\r\n                db.collection(\"teams\")\r\n                  .doc(projectId)\r\n                  .update({\r\n                    projects: projects,\r\n                  })\r\n                  .then(() => {\r\n                    this.getTeams();\r\n                    this.$alert(\r\n                      `New project ${this.projectName} added`,\r\n                      \"Success\",\r\n                      \"success\"\r\n                    );\r\n                    this.projectName = \"\";\r\n                    this.projectBudget = \"\";\r\n                  })\r\n                  .catch((error) => {\r\n                    console.error(\"Error adding project:\", error);\r\n                  });\r\n              });\r\n            })\r\n            .catch((error) => {\r\n              console.error(\"Error getting team:\", error);\r\n            });\r\n        } else {\r\n          this.$alert(\"Budget needs to be number\", \"Warning\", \"warning\");\r\n        }\r\n      } else {\r\n        this.$alert(\"Cant submit empty fields\", \"Warning\", \"warning\");\r\n      }\r\n    },\r\n    deleteTeam(team) {\r\n      this.$confirm(\"Are you sure?\").then(() => {\r\n        db.collection(\"teams\")\r\n          .get()\r\n          .then((query) => {\r\n            query.forEach((doc) => {\r\n              const data = doc.data();\r\n              const id = doc.id;\r\n              if (\r\n                data.name === team.teamName &&\r\n                data.budget === team.teamBudget\r\n              ) {\r\n                db.collection(\"teams\")\r\n                  .doc(id)\r\n                  .delete()\r\n                  .then(() => {\r\n                    this.$alert(\r\n                      `Team ${team.teamName} deleted`,\r\n                      \"Success\",\r\n                      \"success\"\r\n                    );\r\n                    this.getTeams();\r\n                  })\r\n                  .catch((error) => {\r\n                    console.error(\"Error removing team: \", error);\r\n                  });\r\n              }\r\n            });\r\n          });\r\n      });\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  font-weight: bold;\r\n  margin: 0px 20px;\r\n}\r\n\r\n.form-group input {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n.form-group select {\r\n  display: block;\r\n  width: 30%;\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n.blue-button {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  background-color: rgba(41, 133, 133, 0.3);\r\n  color: black;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  border: 1px solid black;\r\n}\r\n\r\n.red-button {\r\n  display: block;\r\n  width: 40%;\r\n  background-color: rgba(255, 0, 0, 0.25);\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n</style>"]}]}