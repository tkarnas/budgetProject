{"remainingRequest":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tomo/Documents/projects/vue-diplomski/src/components/Projects.vue?vue&type=style&index=0&id=60dc6baa&scoped=true&lang=css&","dependencies":[{"path":"/Users/tomo/Documents/projects/vue-diplomski/src/components/Projects.vue","mtime":1680948623761},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/css-loader/dist/cjs.js","mtime":1680948621394},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1680948623381},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/postcss-loader/src/index.js","mtime":1680948622442},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js","mtime":1680948623381}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnJlZC1idXR0b24gew0KICBkaXNwbGF5OiBibG9jazsNCiAgcGFkZGluZy1sZWZ0OiAxNXB4Ow0KICB3aWR0aDogMzAlOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMCwgMCwgMC4xMyk7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBtYXJnaW4tdG9wOiAycHg7DQogIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOw0KfQ0KDQouYnV0dG9uIHsNCiAgZGlzcGxheTogYmxvY2s7DQogIHBhZGRpbmctbGVmdDogMTVweDsNCiAgd2lkdGg6IDMwJTsNCiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxMzYsIDIzOCwgNjksIDAuMjg4KTsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICBjdXJzb3I6IHBvaW50ZXI7DQogIG1hcmdpbi10b3A6IDJweDsNCiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7DQp9DQoNCi5leHBhbmQgew0KICBkaXNwbGF5OiBibG9jazsNCiAgcGFkZGluZy1sZWZ0OiAxNXB4Ow0KICB3aWR0aDogMzAlOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDQzLCAxNDYsIDE3MiwgMC40MzgpOw0KICBib3JkZXItcmFkaXVzOiA0cHg7DQogIGN1cnNvcjogcG9pbnRlcjsNCiAgbWFyZ2luLXRvcDogMnB4Ow0KICBib3JkZXI6IDFweCBzb2xpZCBibGFjazsNCn0NCg0KLnByb2plY3RzIHsNCiAgbWFyZ2luLXRvcDogMjBweDsNCiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNDAsIDIzMCwgMTQwLCAwLjIpOw0KICBtYXgtd2lkdGg6IDEwMCU7DQogIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOw0KICBib3JkZXItcmFkaXVzOiA0cHg7DQogIHBhZGRpbmc6IDVweDsNCn0NCg0KdWwgew0KICBsaXN0LXN0eWxlOiBub25lOw0KICBwYWRkaW5nOiAwOw0KICBtYXJnaW46IDA7DQp9DQoNCmxpIHsNCiAgbWFyZ2luOiAxMHB4IDA7DQp9DQo="},{"version":3,"sources":["Projects.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Projects.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <ul v-if=\"isAdmin || isTeamLead || isUser\">\r\n      <li v-for=\"(project, projectIndex) in team.projects\" :key=\"projectIndex\">\r\n        <div class=\"projects\" v-if=\"userCanSee(project)\">\r\n          Project Name: {{ project.projectName }}\r\n          <div v-if=\"!isUser\">\r\n            Project Budget: {{ project.projectBudget }} €\r\n            <br />\r\n            <b\r\n              >Left:\r\n              {{\r\n                project.projectBudget -\r\n                project.expenses.reduce((a, b) => a + (b[\"amount\"] || 0), 0)\r\n              }}\r\n              €</b\r\n            >\r\n          </div>\r\n          <div\r\n            class=\"button\"\r\n            v-if=\"project.expenses.length && !isUser\"\r\n            @click=\"isClicked = !isClicked\"\r\n          >\r\n            Check expenses\r\n            <div v-if=\"isClicked\">\r\n              <div v-for=\"(expense, index) in project.expenses\" :key=\"index\">\r\n                {{ expense.moment }} - {{ expense.amount }} € - Reason:\r\n                {{ expense.reason }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"expand\"\r\n            v-if=\"project.people.length && !isUser\"\r\n            @click=\"isClicked2 = !isClicked2\"\r\n          >\r\n            Project members\r\n            <div v-if=\"isClicked2\">\r\n              <div v-for=\"(people, index) in project.people\" :key=\"index\">\r\n                {{ people }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"!isUser\">\r\n            <Graph :project=\"project\"></Graph>\r\n          </div>\r\n          <div\r\n            class=\"red-button\"\r\n            v-if=\"isAdmin\"\r\n            @click=\"deleteProject(teamIndex, projectIndex, project)\"\r\n          >\r\n            Delete\r\n          </div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Graph from \"../components/Graph.vue\";\r\nimport { db } from \"@/firebase\";\r\nimport store from \"@/store.js\";\r\n\r\nexport default {\r\n  name: \"RoleForm\",\r\n  components: {\r\n    Graph,\r\n  },\r\n  props: [\r\n    \"isAdmin\",\r\n    \"isTeamLead\",\r\n    \"isUser\",\r\n    \"team\",\r\n    \"rights\",\r\n    \"teamIndex\",\r\n    \"teams\",\r\n  ],\r\n  data() {\r\n    return {\r\n      isClicked: false,\r\n      isClicked2: false,\r\n    };\r\n  },\r\n  methods: {\r\n    getTeams() {\r\n      this.$emit(\"call-get-teams\");\r\n    },\r\n    showNoProjectsWindow() {\r\n      this.$emit(\"no-projects\");\r\n    },\r\n    userCanSee(project) {\r\n      if (this.rights === \"Admin\" || this.rights === \"Team Lead\") {\r\n        return true;\r\n      }\r\n      if (project.people && project.people.length) {\r\n        let found;\r\n        for (const user of project.people) {\r\n          if (user === this.signedUser) {\r\n            found = true;\r\n            if (!found) {\r\n              this.showNoProjectsWindow();\r\n            }\r\n          }\r\n          return true;\r\n        }\r\n      }\r\n      this.showNoProjectsWindow();\r\n      return false;\r\n    },\r\n    deleteProject(teamIndex, projectIndex, project) {\r\n      this.$confirm(\"Are you sure?\").then(() => {\r\n        const team = this.teams[teamIndex];\r\n        db.collection(\"teams\")\r\n          .where(\"name\", \"==\", team.teamName)\r\n          .where(\"budget\", \"==\", team.teamBudget)\r\n          .get()\r\n          .then((snapshot) => {\r\n            if (snapshot.empty) {\r\n              return;\r\n            }\r\n            snapshot.forEach((doc) => {\r\n              const teamId = doc.id;\r\n              let projects = doc.data().projects;\r\n              projects = projects.filter(\r\n                (project, index) => index !== projectIndex\r\n              );\r\n              db.collection(\"teams\")\r\n                .doc(teamId)\r\n                .update({\r\n                  projects: projects,\r\n                })\r\n                .then(() => {\r\n                  this.$alert(\r\n                    `Project ${project.projectName} deleted`,\r\n                    \"Success\",\r\n                    \"success\"\r\n                  );\r\n                  this.getTeams();\r\n                })\r\n                .catch((error) => {\r\n                  this.$alert(error, \"Error\", \"error\");\r\n                });\r\n            });\r\n          })\r\n          .catch((error) => {\r\n            this.$alert(error, \"Error\", \"error\");\r\n          });\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    signedUser() {\r\n      return store.currentUser;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.red-button {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(255, 0, 0, 0.13);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.button {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(136, 238, 69, 0.288);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.expand {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(43, 146, 172, 0.438);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.projects {\r\n  margin-top: 20px;\r\n  background-color: rgba(240, 230, 140, 0.2);\r\n  max-width: 100%;\r\n  border: 1px solid black;\r\n  border-radius: 4px;\r\n  padding: 5px;\r\n}\r\n\r\nul {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\nli {\r\n  margin: 10px 0;\r\n}\r\n</style>"]}]}