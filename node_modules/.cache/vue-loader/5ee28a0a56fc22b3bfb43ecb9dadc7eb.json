{"remainingRequest":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tomo/Documents/projects/vue-diplomski/src/components/ProjectForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tomo/Documents/projects/vue-diplomski/src/components/ProjectForm.vue","mtime":1676484598000},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1675708578000},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/babel-loader/lib/index.js","mtime":1675708564000},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1675708578000},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js","mtime":1675708910000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBkYiB9IGZyb20gIkAvZmlyZWJhc2UiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJQcm9qZWN0Rm9ybSIsDQogIHByb3BzOiBbImlzQWRtaW4iLCAiaXNUZWFtTGVhZCIsICJpc1VzZXIiLCAidGVhbSJdLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBwcm9qZWN0TmFtZTogIiIsDQogICAgICBwcm9qZWN0QnVkZ2V0OiBudWxsLA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6DQogIHsNCiAgICBnZXRUZWFtcygpIHsNCiAgICAgIHRoaXMuJGVtaXQoImNhbGwtZ2V0LXRlYW1zIik7DQogICAgfSwNCiAgICBhc3luYyBhZGRQcm9qZWN0KHRlYW0pIHsNCiAgICAgIGlmICgNCiAgICAgICAgdGhpcy5wcm9qZWN0TmFtZSAhPSBudWxsICYmDQogICAgICAgIHRoaXMucHJvamVjdEJ1ZGdldCAhPSBudWxsICYmDQogICAgICAgIHRoaXMucHJvamVjdE5hbWUgIT0gIiIgJiYNCiAgICAgICAgdGhpcy5wcm9qZWN0QnVkZ2V0ICE9ICIiDQogICAgICApIHsNCiAgICAgICAgaWYgKHR5cGVvZiBwYXJzZUludCh0aGlzLnByb2plY3RCdWRnZXQsIDEwKSA9PT0gIm51bWJlciIpIHsNCiAgICAgICAgICBpZiAocGFyc2VJbnQodGhpcy5wcm9qZWN0QnVkZ2V0LCAxMCkgPiB0ZWFtLnRlYW1CdWRnZXQpIHsNCiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KCJOdW1iZXIgb3ZlciB0aGUgYnVkZ2V0IiwgIldhcm5pbmciLCAid2FybmluZyIpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCiAgICAgICAgICBsZXQgcHJvamVjdEFscmVhZHlMb3N0ID0gMDsNCiAgICAgICAgICBmb3IgKGNvbnN0IHByb2plY3Qgb2YgdGVhbS5wcm9qZWN0cykgew0KICAgICAgICAgICAgcHJvamVjdEFscmVhZHlMb3N0ICs9IHBhcnNlSW50KHByb2plY3QucHJvamVjdEJ1ZGdldCwgMTApOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAoDQogICAgICAgICAgICBwcm9qZWN0QWxyZWFkeUxvc3QgKyBwYXJzZUludCh0aGlzLnByb2plY3RCdWRnZXQsIDEwKSA+DQogICAgICAgICAgICB0ZWFtLnRlYW1CdWRnZXQNCiAgICAgICAgICApIHsNCiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KCJpbnN1ZmZpY2llbnQgZnVuZHMiLCAiV2FybmluZyIsICJ3YXJuaW5nIik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgfQ0KDQogICAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKQ0KICAgICAgICAgICAgLndoZXJlKCJuYW1lIiwgIj09IiwgdGVhbS50ZWFtTmFtZSkNCiAgICAgICAgICAgIC53aGVyZSgiYnVkZ2V0IiwgIj09IiwgdGVhbS50ZWFtQnVkZ2V0KQ0KICAgICAgICAgICAgLmdldCgpDQogICAgICAgICAgICAudGhlbigoc25hcHNob3QpID0+IHsNCiAgICAgICAgICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYykgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHByb2plY3RJZCA9IGRvYy5pZDsNCiAgICAgICAgICAgICAgICBsZXQgcHJvamVjdHMgPSBkb2MuZGF0YSgpLnByb2plY3RzOw0KICAgICAgICAgICAgICAgIHByb2plY3RzLnB1c2goew0KICAgICAgICAgICAgICAgICAgcHJvamVjdE5hbWU6IHRoaXMucHJvamVjdE5hbWUsDQogICAgICAgICAgICAgICAgICBwcm9qZWN0QnVkZ2V0OiB0aGlzLnByb2plY3RCdWRnZXQsDQogICAgICAgICAgICAgICAgICBleHBlbnNlczogW10sDQogICAgICAgICAgICAgICAgICBwZW9wbGU6IFtdLA0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGRiLmNvbGxlY3Rpb24oInRlYW1zIikNCiAgICAgICAgICAgICAgICAgIC5kb2MocHJvamVjdElkKQ0KICAgICAgICAgICAgICAgICAgLnVwZGF0ZSh7DQogICAgICAgICAgICAgICAgICAgIHByb2plY3RzOiBwcm9qZWN0cywNCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGVhbXMoKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYWxlcnQoDQogICAgICAgICAgICAgICAgICAgICAgYE5ldyBwcm9qZWN0ICR7dGhpcy5wcm9qZWN0TmFtZX0gYWRkZWRgLA0KICAgICAgICAgICAgICAgICAgICAgICJTdWNjZXNzIiwNCiAgICAgICAgICAgICAgICAgICAgICAic3VjY2VzcyINCiAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9qZWN0TmFtZSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2plY3RCdWRnZXQgPSAiIjsNCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGFkZGluZyBwcm9qZWN0OiIsIGVycm9yKTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGdldHRpbmcgdGVhbToiLCBlcnJvcik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiRhbGVydCgiQnVkZ2V0IG5lZWRzIHRvIGJlIG51bWJlciIsICJXYXJuaW5nIiwgIndhcm5pbmciKTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kYWxlcnQoIkNhbnQgc3VibWl0IGVtcHR5IGZpZWxkcyIsICJXYXJuaW5nIiwgIndhcm5pbmciKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGRlbGV0ZVRlYW0odGVhbSkgew0KICAgICAgdGhpcy4kY29uZmlybSgiQXJlIHlvdSBzdXJlPyIpLnRoZW4oKCkgPT4gew0KICAgICAgICBkYi5jb2xsZWN0aW9uKCJ0ZWFtcyIpDQogICAgICAgICAgLmdldCgpDQogICAgICAgICAgLnRoZW4oKHF1ZXJ5KSA9PiB7DQogICAgICAgICAgICBxdWVyeS5mb3JFYWNoKChkb2MpID0+IHsNCiAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGRvYy5kYXRhKCk7DQogICAgICAgICAgICAgIGNvbnN0IGlkID0gZG9jLmlkOw0KICAgICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICAgZGF0YS5uYW1lID09PSB0ZWFtLnRlYW1OYW1lICYmDQogICAgICAgICAgICAgICAgZGF0YS5idWRnZXQgPT09IHRlYW0udGVhbUJ1ZGdldA0KICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICBkYi5jb2xsZWN0aW9uKCJ0ZWFtcyIpDQogICAgICAgICAgICAgICAgICAuZG9jKGlkKQ0KICAgICAgICAgICAgICAgICAgLmRlbGV0ZSgpDQogICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJGFsZXJ0KA0KICAgICAgICAgICAgICAgICAgICAgIGBUZWFtICR7dGVhbS50ZWFtTmFtZX0gZGVsZXRlZGAsDQogICAgICAgICAgICAgICAgICAgICAgIlN1Y2Nlc3MiLA0KICAgICAgICAgICAgICAgICAgICAgICJzdWNjZXNzIg0KICAgICAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFRlYW1zKCk7DQogICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciByZW1vdmluZyB0ZWFtOiAiLCBlcnJvcik7DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICB9DQp9Ow0K"},{"version":3,"sources":["ProjectForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProjectForm.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <form v-if=\"isAdmin || isTeamLead\">\r\n        <div class=\"form-group\" ref_testcafe=\"addProjectForm\">\r\n            <label for=\"projectName\">Project Name</label>\r\n            <input\r\n            type=\"text\"\r\n            id=\"projectName\"\r\n            v-model=\"projectName\"\r\n            placeholder=\"Enter project name\"\r\n            />\r\n            <label for=\"projectBudget\">Project budget</label>\r\n            <input\r\n            type=\"number\"\r\n            id=\"projectBudget\"\r\n            v-model=\"projectBudget\"\r\n            placeholder=\"Enter project budget\"\r\n            />\r\n        </div>\r\n        <button\r\n            class=\"blue-button\"\r\n            type=\"submit\"\r\n            @click.prevent=\"addProject(team)\"\r\n            ref_testcafe=\"submitAddProjectButton\"\r\n        >\r\n            Add Project\r\n        </button>\r\n        <button\r\n            class=\"red-button\"\r\n            type=\"submit\"\r\n            v-if=\"isAdmin\"\r\n            @click.prevent=\"deleteTeam(team)\"\r\n        >\r\n            Delete Team\r\n        </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { db } from \"@/firebase\";\r\n\r\nexport default {\r\n  name: \"ProjectForm\",\r\n  props: [\"isAdmin\", \"isTeamLead\", \"isUser\", \"team\"],\r\n  data() {\r\n    return {\r\n      projectName: \"\",\r\n      projectBudget: null,\r\n    };\r\n  },\r\n  methods:\r\n  {\r\n    getTeams() {\r\n      this.$emit(\"call-get-teams\");\r\n    },\r\n    async addProject(team) {\r\n      if (\r\n        this.projectName != null &&\r\n        this.projectBudget != null &&\r\n        this.projectName != \"\" &&\r\n        this.projectBudget != \"\"\r\n      ) {\r\n        if (typeof parseInt(this.projectBudget, 10) === \"number\") {\r\n          if (parseInt(this.projectBudget, 10) > team.teamBudget) {\r\n            this.$alert(\"Number over the budget\", \"Warning\", \"warning\");\r\n            return;\r\n          }\r\n          let projectAlreadyLost = 0;\r\n          for (const project of team.projects) {\r\n            projectAlreadyLost += parseInt(project.projectBudget, 10);\r\n          }\r\n          if (\r\n            projectAlreadyLost + parseInt(this.projectBudget, 10) >\r\n            team.teamBudget\r\n          ) {\r\n            this.$alert(\"insufficient funds\", \"Warning\", \"warning\");\r\n            return;\r\n          }\r\n\r\n          db.collection(\"teams\")\r\n            .where(\"name\", \"==\", team.teamName)\r\n            .where(\"budget\", \"==\", team.teamBudget)\r\n            .get()\r\n            .then((snapshot) => {\r\n              if (snapshot.empty) {\r\n                return;\r\n              }\r\n              snapshot.forEach((doc) => {\r\n                const projectId = doc.id;\r\n                let projects = doc.data().projects;\r\n                projects.push({\r\n                  projectName: this.projectName,\r\n                  projectBudget: this.projectBudget,\r\n                  expenses: [],\r\n                  people: [],\r\n                });\r\n                db.collection(\"teams\")\r\n                  .doc(projectId)\r\n                  .update({\r\n                    projects: projects,\r\n                  })\r\n                  .then(() => {\r\n                    this.getTeams();\r\n                    this.$alert(\r\n                      `New project ${this.projectName} added`,\r\n                      \"Success\",\r\n                      \"success\"\r\n                    );\r\n                    this.projectName = \"\";\r\n                    this.projectBudget = \"\";\r\n                  })\r\n                  .catch((error) => {\r\n                    console.error(\"Error adding project:\", error);\r\n                  });\r\n              });\r\n            })\r\n            .catch((error) => {\r\n              console.error(\"Error getting team:\", error);\r\n            });\r\n        } else {\r\n          this.$alert(\"Budget needs to be number\", \"Warning\", \"warning\");\r\n        }\r\n      } else {\r\n        this.$alert(\"Cant submit empty fields\", \"Warning\", \"warning\");\r\n      }\r\n    },\r\n    deleteTeam(team) {\r\n      this.$confirm(\"Are you sure?\").then(() => {\r\n        db.collection(\"teams\")\r\n          .get()\r\n          .then((query) => {\r\n            query.forEach((doc) => {\r\n              const data = doc.data();\r\n              const id = doc.id;\r\n              if (\r\n                data.name === team.teamName &&\r\n                data.budget === team.teamBudget\r\n              ) {\r\n                db.collection(\"teams\")\r\n                  .doc(id)\r\n                  .delete()\r\n                  .then(() => {\r\n                    this.$alert(\r\n                      `Team ${team.teamName} deleted`,\r\n                      \"Success\",\r\n                      \"success\"\r\n                    );\r\n                    this.getTeams();\r\n                  })\r\n                  .catch((error) => {\r\n                    console.error(\"Error removing team: \", error);\r\n                  });\r\n              }\r\n            });\r\n          });\r\n      });\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  font-weight: bold;\r\n  margin: 0px 20px;\r\n}\r\n\r\n.form-group input {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n.form-group select {\r\n  display: block;\r\n  width: 30%;\r\n  padding: 10px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n}\r\n\r\n.blue-button {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 10px;\r\n  background-color: rgba(41, 133, 133, 0.3);\r\n  color: black;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  border: 1px solid black;\r\n}\r\n\r\n.red-button {\r\n  display: block;\r\n  width: 40%;\r\n  background-color: rgba(255, 0, 0, 0.25);\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n</style>"]}]}