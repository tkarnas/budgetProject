{"remainingRequest":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/babel-loader/lib/index.js!/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tomo/Documents/projects/vue-diplomski/src/components/Projects.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tomo/Documents/projects/vue-diplomski/src/components/Projects.vue","mtime":1683032952162},{"path":"/Users/tomo/Documents/projects/vue-diplomski/babel.config.js","mtime":1680948619828},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/babel-loader/lib/index.js","mtime":1680948621002},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/cache-loader/dist/cjs.js","mtime":1680948621095},{"path":"/Users/tomo/Documents/projects/vue-diplomski/node_modules/vue-loader/lib/index.js","mtime":1680948623381}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy90b21vL0RvY3VtZW50cy9wcm9qZWN0cy92dWUtZGlwbG9tc2tpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBHcmFwaCBmcm9tICIuLi9jb21wb25lbnRzL0dyYXBoLnZ1ZSI7CmltcG9ydCB7IGRiIH0gZnJvbSAiQC9maXJlYmFzZSI7CmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJSb2xlRm9ybSIsCiAgY29tcG9uZW50czogewogICAgR3JhcGg6IEdyYXBoCiAgfSwKICBwcm9wczogWyJpc0FkbWluIiwgImlzVGVhbUxlYWQiLCAiaXNVc2VyIiwgInRlYW0iLCAicmlnaHRzIiwgInRlYW1JbmRleCIsICJ0ZWFtcyJdLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc0NsaWNrZWQ6IGZhbHNlLAogICAgICBpc0NsaWNrZWQyOiBmYWxzZQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFRlYW1zOiBmdW5jdGlvbiBnZXRUZWFtcygpIHsKICAgICAgdGhpcy4kZW1pdCgiY2FsbC1nZXQtdGVhbXMiKTsKICAgIH0sCiAgICBzaG93Tm9Qcm9qZWN0c1dpbmRvdzogZnVuY3Rpb24gc2hvd05vUHJvamVjdHNXaW5kb3coKSB7CiAgICAgIHRoaXMuJGVtaXQoIm5vLXByb2plY3RzIik7CiAgICB9LAogICAgdXNlckNhblNlZTogZnVuY3Rpb24gdXNlckNhblNlZShwcm9qZWN0KSB7CiAgICAgIGlmICh0aGlzLnJpZ2h0cyA9PT0gIkFkbWluIiB8fCB0aGlzLnJpZ2h0cyA9PT0gIlRlYW0gTGVhZCIpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKHByb2plY3QucGVvcGxlICYmIHByb2plY3QucGVvcGxlLmxlbmd0aCkgewogICAgICAgIHZhciBmb3VuZDsKCiAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHByb2plY3QucGVvcGxlKSwKICAgICAgICAgICAgX3N0ZXA7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgdXNlciA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgICAgaWYgKHVzZXIgPT09IHRoaXMuc2lnbmVkVXNlcikgewogICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKCiAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgICAgICAgdGhpcy5zaG93Tm9Qcm9qZWN0c1dpbmRvdygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGRlbGV0ZVByb2plY3Q6IGZ1bmN0aW9uIGRlbGV0ZVByb2plY3QodGVhbUluZGV4LCBwcm9qZWN0SW5kZXgsIHByb2plY3QpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0oIkFyZSB5b3Ugc3VyZT8iKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdGVhbSA9IF90aGlzLnRlYW1zW3RlYW1JbmRleF07CiAgICAgICAgZGIuY29sbGVjdGlvbigidGVhbXMiKS53aGVyZSgibmFtZSIsICI9PSIsIHRlYW0udGVhbU5hbWUpLndoZXJlKCJidWRnZXQiLCAiPT0iLCB0ZWFtLnRlYW1CdWRnZXQpLmdldCgpLnRoZW4oZnVuY3Rpb24gKHNuYXBzaG90KSB7CiAgICAgICAgICBpZiAoc25hcHNob3QuZW1wdHkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNuYXBzaG90LmZvckVhY2goZnVuY3Rpb24gKGRvYykgewogICAgICAgICAgICB2YXIgdGVhbUlkID0gZG9jLmlkOwogICAgICAgICAgICB2YXIgcHJvamVjdHMgPSBkb2MuZGF0YSgpLnByb2plY3RzOwogICAgICAgICAgICBwcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihmdW5jdGlvbiAocHJvamVjdCwgaW5kZXgpIHsKICAgICAgICAgICAgICByZXR1cm4gaW5kZXggIT09IHByb2plY3RJbmRleDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRiLmNvbGxlY3Rpb24oInRlYW1zIikuZG9jKHRlYW1JZCkudXBkYXRlKHsKICAgICAgICAgICAgICBwcm9qZWN0czogcHJvamVjdHMKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXMuJGFsZXJ0KCJQcm9qZWN0ICIuY29uY2F0KHByb2plY3QucHJvamVjdE5hbWUsICIgZGVsZXRlZCIpLCAiU3VjY2VzcyIsICJzdWNjZXNzIik7CgogICAgICAgICAgICAgIF90aGlzLmdldFRlYW1zKCk7CiAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgICAgIF90aGlzLiRhbGVydChlcnJvciwgIkVycm9yIiwgImVycm9yIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBfdGhpcy4kYWxlcnQoZXJyb3IsICJFcnJvciIsICJlcnJvciIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBzaWduZWRVc2VyOiBmdW5jdGlvbiBzaWduZWRVc2VyKCkgewogICAgICByZXR1cm4gc3RvcmUuY3VycmVudFVzZXI7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["Projects.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <ul v-if=\"isAdmin || isTeamLead || isUser\">\r\n      <li v-for=\"(project, projectIndex) in team.projects\" :key=\"projectIndex\">\r\n        <div class=\"projects\" v-if=\"userCanSee(project)\">\r\n          Project Name: {{ project.projectName }}\r\n          <div v-if=\"!isUser\">\r\n            Project Budget: {{ project.projectBudget }} €\r\n            <br />\r\n            <b\r\n              >Left:\r\n              {{\r\n                project.projectBudget -\r\n                project.expenses.reduce((a, b) => a + (b[\"amount\"] || 0), 0)\r\n              }}\r\n              €</b\r\n            >\r\n          </div>\r\n          <div\r\n            class=\"button\"\r\n            v-if=\"project.expenses.length && !isUser\"\r\n            @click=\"isClicked = !isClicked\"\r\n          >\r\n            Check expenses\r\n            <div v-if=\"isClicked\">\r\n              <div v-for=\"(expense, index) in project.expenses\" :key=\"index\">\r\n                {{ expense.moment }} - {{ expense.amount }} € - Reason:\r\n                {{ expense.reason }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"expand\"\r\n            v-if=\"project.people.length\"\r\n            @click=\"isClicked2 = !isClicked2\"\r\n          >\r\n            Project members\r\n            <div v-if=\"isClicked2\">\r\n              <div v-for=\"(people, index) in project.people\" :key=\"index\">\r\n                {{ people }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div v-if=\"!isUser\">\r\n            <Graph :project=\"project\"></Graph>\r\n          </div>\r\n          <div\r\n            class=\"red-button\"\r\n            v-if=\"isAdmin\"\r\n            @click=\"deleteProject(teamIndex, projectIndex, project)\"\r\n          >\r\n            Delete\r\n          </div>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Graph from \"../components/Graph.vue\";\r\nimport { db } from \"@/firebase\";\r\nimport store from \"@/store.js\";\r\n\r\nexport default {\r\n  name: \"RoleForm\",\r\n  components: {\r\n    Graph,\r\n  },\r\n  props: [\r\n    \"isAdmin\",\r\n    \"isTeamLead\",\r\n    \"isUser\",\r\n    \"team\",\r\n    \"rights\",\r\n    \"teamIndex\",\r\n    \"teams\",\r\n  ],\r\n  data() {\r\n    return {\r\n      isClicked: false,\r\n      isClicked2: false,\r\n    };\r\n  },\r\n  methods: {\r\n    getTeams() {\r\n      this.$emit(\"call-get-teams\");\r\n    },\r\n    showNoProjectsWindow() {\r\n      this.$emit(\"no-projects\");\r\n    },\r\n    userCanSee(project) {\r\n      if (this.rights === \"Admin\" || this.rights === \"Team Lead\") {\r\n        return true;\r\n      }\r\n      if (project.people && project.people.length) {\r\n        let found;\r\n        for (const user of project.people) {\r\n          if (user === this.signedUser) {\r\n            found = true;\r\n            if (!found) {\r\n              this.showNoProjectsWindow();\r\n            }\r\n          }\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    },\r\n    deleteProject(teamIndex, projectIndex, project) {\r\n      this.$confirm(\"Are you sure?\").then(() => {\r\n        const team = this.teams[teamIndex];\r\n        db.collection(\"teams\")\r\n          .where(\"name\", \"==\", team.teamName)\r\n          .where(\"budget\", \"==\", team.teamBudget)\r\n          .get()\r\n          .then((snapshot) => {\r\n            if (snapshot.empty) {\r\n              return;\r\n            }\r\n            snapshot.forEach((doc) => {\r\n              const teamId = doc.id;\r\n              let projects = doc.data().projects;\r\n              projects = projects.filter(\r\n                (project, index) => index !== projectIndex\r\n              );\r\n              db.collection(\"teams\")\r\n                .doc(teamId)\r\n                .update({\r\n                  projects: projects,\r\n                })\r\n                .then(() => {\r\n                  this.$alert(\r\n                    `Project ${project.projectName} deleted`,\r\n                    \"Success\",\r\n                    \"success\"\r\n                  );\r\n                  this.getTeams();\r\n                })\r\n                .catch((error) => {\r\n                  this.$alert(error, \"Error\", \"error\");\r\n                });\r\n            });\r\n          })\r\n          .catch((error) => {\r\n            this.$alert(error, \"Error\", \"error\");\r\n          });\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    signedUser() {\r\n      return store.currentUser;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.red-button {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 30%;\r\n  background-color: rgba(255, 0, 0, 0.13);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.button {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 50%;\r\n  background-color: rgba(136, 238, 69, 0.288);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.expand {\r\n  display: block;\r\n  padding-left: 15px;\r\n  width: 50%;\r\n  background-color: rgba(43, 146, 172, 0.438);\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  margin-top: 2px;\r\n  border: 1px solid black;\r\n}\r\n\r\n.projects {\r\n  margin-top: 20px;\r\n  background-color: rgba(240, 230, 140, 0.2);\r\n  max-width: 100%;\r\n  border: 1px solid black;\r\n  border-radius: 4px;\r\n  padding: 5px;\r\n}\r\n\r\nul {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n}\r\n\r\nli {\r\n  margin: 10px 0;\r\n}\r\n</style>"],"sourceRoot":"src/components"}]}